<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram AI Marketing</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="/">Instagram AI Marketing</a>
            <div class="navbar-nav ms-auto">
                <button class="btn btn-outline-primary me-2" data-bs-toggle="modal" data-bs-target="#loginModal">로그인</button>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#registerModal">회원가입</button>
            </div>
        </div>
    </nav>
    <!-- 로그인 모달 -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="loginModalLabel">로그인</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="login-form">
              <div class="mb-3">
                <label for="login-email" class="form-label">이메일</label>
                <input type="email" class="form-control" id="login-email" required>
              </div>
              <div class="mb-3">
                <label for="login-password" class="form-label">비밀번호</label>
                <input type="password" class="form-control" id="login-password" required>
              </div>
              <button type="submit" class="btn btn-primary w-100" id="login-btn">로그인</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- 회원가입 모달 -->
    <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="registerModalLabel">회원가입</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="register-form">
              <div class="mb-3">
                <label for="register-business" class="form-label">비즈니스명</label>
                <input type="text" class="form-control" id="register-business" required>
              </div>
              <div class="mb-3">
                <label for="register-email" class="form-label">이메일</label>
                <input type="email" class="form-control" id="register-email" required>
              </div>
              <div class="mb-3">
                <label for="register-password" class="form-label">비밀번호</label>
                <input type="password" class="form-control" id="register-password" required>
              </div>
              <div class="mb-3">
                <label for="register-industry" class="form-label">업종</label>
                <select class="form-select" id="register-industry" required>
                  <option value="">업종 선택</option>
                  <option value="restaurant">음식점</option>
                  <option value="fashion">패션</option>
                  <option value="beauty">뷰티</option>
                  <option value="fitness">피트니스</option>
                  <option value="retail">소매업</option>
                  <option value="software">소프트웨어</option>
                  <option value="consulting">컨설팅</option>
                  <option value="other">기타</option>
                </select>
              </div>
              <button type="submit" class="btn btn-primary w-100">회원가입</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // 로그인
        const loginForm = document.getElementById('login-form');
        if (loginForm) {
            loginForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                try {
                    const res = await fetch('/api/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, password })
                    });
                    const data = await res.json();
                    if (res.ok && data.access_token) {
                        localStorage.setItem('access_token', data.access_token);
                        window.location.href = '/dashboard';
                    } else {
                        alert(data.detail || data.message || '로그인 실패');
                    }
                } catch (err) {
                    alert('네트워크 오류 또는 서버 오류');
                }
            });
        }
        // 회원가입
        const registerForm = document.getElementById('register-form');
        if (registerForm) {
            registerForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                const business_name = document.getElementById('register-business').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const industry = document.getElementById('register-industry').value;
                const target_audience = '일반 고객';
                const brand_voice = '친근하고 전문적인';
                try {
                    const res = await fetch('/api/register', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ business_name, email, password, industry, target_audience, brand_voice })
                    });
                    const data = await res.json();
                    if (res.ok && data.success) {
                        window.location.href = '/dashboard';
                    } else {
                        alert(data.detail || data.message || '회원가입 실패');
                    }
                } catch (err) {
                    alert('네트워크 오류 또는 서버 오류');
                }
            });
        }
    });
    </script>
</body>
</html>